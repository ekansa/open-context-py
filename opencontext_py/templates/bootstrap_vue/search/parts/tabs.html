{% block search_tabs %}

<template id="all-search-tabs-temp">
  <div>
    <ul class="nav nav-tabs" id="search-tabs-nav" role="tablist">
      <li class="nav-item" role="presentation">
        <a 
          class="nav-link active" 
          id="tab-map-time-ranges" 
          data-toggle="tab"
          href="#map-time-ranges" 
          aria-controls="map-time-ranges" 
          aria-selected="true">Map and Time Ranges</a>
      </li>
    </ul>
    <div class="tab-content" id="all-search-tabs">
      <div 
        class="tab-pane fade show active"
        id="map-time-ranges" 
        role="tabpanel" 
        aria-labelledby="tab-map-time-range">

        <div class="card">
          <div class="card-header">
            <h5 v-if="result">
                <span class="text-left">Map</span>
                <span class="text-right">[[ result['totalResults'] ]] Records</span>
            </h5>
            <h5 v-else>
                <span class="text-left">Map</span>
                <span class="text-right">Loading Records...</span>
            </h5>
          </div>
          <div class="card-body">
            <div id="app_media" v-if="result">
              <common_map
                :map_key="0"
                :map_class="'map_preview'"
                :min_height="800"
                :ref_suffix="'search-map'"
                v-bind:geo_json="result"></common_map>
            </div>
            <div class="jumbotron jumbotron-fluid" v-else>
                <div class="container-fluid text-muted text-center">
                  <h1 class="display-4">Getting map data...</h1>
                  <b-spinner class="m-5" label="Busy"></b-spinner>
                </div>
            </div>
          </div>
        </div>


      <div v-if="chrono_facets">
        <chronotiles
            :key="'chrono-tiles-component-' + chrono_tiles_component_key_index"
            v-bind:result_id="result.id"
            v-bind:chrono_facets="chrono_facets"></chronotiles>
      </div>

      </div>
    </div>
  </div>
</template>


<script type="text/javascript">

var vc_all_search_tabs = Vue.component(
    'all-search-tabs',
    {
      delimiters: ['[[', ']]'],
      props: ['result', 'chrono_facets', 'chrono_tiles_component_key_index'],
      template: '#all-search-tabs-temp',
      data: {
        message: 'Open Context Search Result',
        result: null,
        map: null,
        tile_layer: null,
        emit_update_fetch_done: false,
        chrono_tiles_component_key_index: 0,
      },
      methods: {
      },
      components: {
        'common_map': vc_common_map,
        'chronotiles': vc_chronotiles,
      }
    }
);

</script>

{% endblock %}